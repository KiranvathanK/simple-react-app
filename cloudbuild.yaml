---

steps:

  - name: gcr.io/cloud-builders/docker

    entrypoint: bash

    args:

      - -c

      - docker login --username=$$DOCKER_USERNAME --password=$$DOCKER_PASSWORD

    secretEnv:

      - DOCKER_USERNAME

      - DOCKER_PASSWORD

  - name: gcr.io/cloud-builders/docker

    entrypoint: bash

    args:

      - -c

      - docker run $$DOCKER_USERNAME/datahub_images:fe_image_latest

    secretEnv:

      - DOCKER_USERNAME

availableSecrets:

  secretManager:

    - versionName: projects/ardent-iris-389305/secrets/DOCKER_PASSWORD/versions/1

      env: DOCKER_PASSWORD

    - versionName: projects/ardent-iris-389305/secrets/DOCKER_USERNAME/versions/1

      env: DOCKER_USERNAME

options:

  logging: NONE
